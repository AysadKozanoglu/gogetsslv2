function processDNS_method(){if($("#dns_method").hasClass("loaded"))return void $("#dns_method").show();if("string"!=typeof gogetssl_other_methods.dns.record&&!/CNAME/.test(gogetssl_other_methods.dns.record))return void alert("error processing DNS authorisation");var t=gogetssl_other_methods.dns.record.split("CNAME"),e=t[0].split(".")[0],o=t[1];$(".dns_method_cname").text(e),$(".dns_method_cname_point").text(o),$("#dns_method").show().addClass("loaded")}function processHTTP_method(){return $("#http_method").hasClass("loaded")?void $("#http_method").show():($("#http_method_content").text(gogetssl_other_methods.http.content),$("#http_method_filename").text(gogetssl_other_methods.http.filename),$link=$("<a>").attr({href:gogetssl_other_methods.http.link,target:"_blank"}).text(gogetssl_other_methods.http.link),$("#http_methods_download").attr({download:gogetssl_other_methods.http.filename,href:"data:text/plain;charset=UTF-8,"+encodeURIComponent(gogetssl_other_methods.http.content)}),$("#http_method_link").append($link),void $("#http_method").show().addClass("loaded"))}function getEmailApproval(){$("#get_approver_email").show(),$("#gogetssl_approver_email").append(new Option("Waiting for emails to load..")),$ajax_query.action="emailAuthorisation",$.ajax({method:"GET",url:$action_url,data:$ajax_query,dataType:"jsonp",cache:!0,success:function(t){1==t.success?($("#gogetssl_approver_email").empty(),$.each(t.data,function(t,e){$("#gogetssl_approver_email").append(new Option(e,t))})):(console.log("getEmailApproval : response error",t),alert("Failed to retrieve email approvers"))},beforeSend:function(){$("#installCsrForm").append($(this).blestaLoadingDialog())},complete:function(){$(".loading_container",$("#installCsrForm")).remove()}})}function getOtherApprovals(){return/BEGIN CERTIFICATE REQUEST/.test($("#gogetssl_csr").val())?($ajax_query.action="authAlternatives",$ajax_query.csr_data=$("#gogetssl_csr").val(),void $.ajax({method:"GET",url:$action_url,data:$ajax_query,dataType:"jsonp",cache:!0,success:function(t){1==t.success&&"object"==typeof t.data.validation?(gogetssl_other_methods.http=t.data.validation.http.http,gogetssl_other_methods.dns=t.data.validation.dns.dns,$("#other_methods_div").show(),processHTTP_method(),$("#get_approver_email").hide(),$("#getAlternatives").remove()):(console.log("getOtherApprovals : ajax error",typeof t),alert("Failed Reason : "+t.data))},beforeSend:function(){$("#installCsrForm").append($(this).blestaLoadingDialog())},complete:function(){$(".loading_container",$("#installCsrForm")).remove()}})):void alert("You need to enter a CSR before we can get other authorization methods")}var gogetssl_other_methods={},loaded={approval_emails:!0};$(document).ready(function(){"object"==typeof $post_back&&$.each($post_back,function(t,e){$("#"+t).length>0&&$("#"+t).val(e)});var t=!0;if("undefined"==typeof document.getElementById("http_methods_download").download&&(console.log("browser doesn't support html5 download attribute using server"),t=!1),"string"!=typeof $action_url||"object"!=typeof $ajax_query)return void alert("can not make ajax query");$(".steps").click(function(){{var t=$(this).attr("step");$(this).attr("step").match(/\d+/)}$(".steps").removeClass("btn-success").addClass("btn-disabled"),$(this).removeClass("btn-disabled").addClass("btn-success"),$(".step_tab").hide(),$("#"+t).show(),"step_3"==t&&0==loaded.approval_emails&&$("#installCsrForm").append($(this).blestaLoadingDialog())}),$("#getAlternatives").click(getOtherApprovals),$("#http_methods_download").click(function(e){return t?void 0:(window.open($action_url+"?action=http_download&contents="+encodeURIComponent(gogetssl_other_methods.http.content)+"&file_name="+encodeURIComponent(gogetssl_other_methods.http.filename),gogetssl_other_methods.http.filename+" Download","window settings"),e.preventDefault(),!1)}),$("#gogetssl_approver_type").change(function(){$(".install_methods").hide();var t=$(this).val();"http"==t&&processHTTP_method(),"dns"==t&&processDNS_method(),"email"==t&&$("#get_approver_email").show()}),$(".install_methods").hide(),$("#other_methods_div").hide(),getEmailApproval()});